---
id: 860-to-870
title: Update 8.6 to 8.7
description: "Review which adjustments must be made to migrate from Camunda 8.6.x to Camunda 8.7.0."
---

The following sections explain which adjustments must be made to migrate from Camunda 8.6.x to 8.7.x for each component.

## Backup

### Google Cloud Storage

Configuring a non-existing bucket for backups will not prevent Zeebe to start up anymore and will only result
in logs (at WARN) in the startup phase.

## Exported records

### `USER_TASK` records

To support User Task Listeners, some backward incompatible changes were necessary to the exported `USER_TASK` records.

#### `assignee` no longer provided in `CREATING/CREATED` events

Previously, when a user task was activating with a specified `assignee`,
we appended the following events of the `USER_TASK` value type:

- `CREATING` with `assignee` property as provided
- `CREATED` with `assignee` property as provided

The `ASSIGNING` and `ASSIGNED` events were not appended in this case.

To support the new User Task Listeners feature, the `assignee` value will not be filled in the `CREATING` and `CREATED` events anymore.

With 8.7, the following events are now appended:

- `CREATING` with `assignee` always `""` (empty string)
- `CREATED` with `assignee` always `""` (empty string)
- `ASSIGNING` with `assignee` property as provided
- `ASSIGNED` with `assignee` property as provided

#### `ASSIGNING` has become `CLAIMING` for `CLAIM` operation

When claiming a user task, we previously appended the following records of the `USER_TASK` value type:

- `CLAIM`
- `ASSIGNING`
- `ASSIGNED`

A new `CLAIMING` intent was introduced to distinguish between claiming and regular assigning.
We now append the following records when claiming a user task:

- `CLAIM`
- `CLAIMING`
- `ASSIGNED`

The `ASSIGNING` event is still appended for assigning a user task.
In that case, we append the following records:

- `ASSIGN`
- `ASSIGNING`
- `ASSIGNED`

## Prefix migration

If a custom prefix has been defined for Operate and Tasklist (for example, using `camunda.operate.elasticsearch.indexPrefix`), then data must be migrated manually to the new indices.

### Make the Elasticsearch instance reachable

The migration relies on communicating directly with Elasticsearch. The Elasticsearch instance must be reachable on `http://localhost:9200`.

- **Kubernetes**: Port-forward your Elasticsearch instance to ensure it is reachable. In the following example, `camunda-platform` can be replaced by the release name:

  ```shell
  kubectl port-forward svc/camunda-platform-elasticsearch 9200:9200
  ```

### Create harmonized indices

To begin creating the harmonized indices for migration, first pull the following Docker image:

```shell
docker pull camunda/zeebe:SNAPSHOT
```

Run the command below, replacing `CAMUNDA_DATABASE_PREFIX` value with your desired prefix:

```shell
docker run --rm -it --env CAMUNDA_DATABASE_URL="host.docker.internal:9200" --env CAMUNDA_DATABASE_INDEXPREFIX=<prefix> --entrypoint /usr/local/zeebe/bin/schema camunda/zeebe:SNAPSHOT
```

### Migrate to harmonized indices

Migrating to the harmonized indices will be done through reindexing.

1. In Postman, import the collection `Prefix migration.postman_collection.json`.
2. In the Postman client, set the global variables which template the requests, where `oldOperatePrefix` and `oldTasklistPrefix` are the prefixes which were previously configured, and `prefix` is the new prefix for your harmonized indices.
3. Execute all requests in the collection.

### Migrate archived indices

For each archived index, you must:

- Put the index in read only mode.
- Clone the index with the changed name.

For example, to migrate `operate-prefix-job-8.6.0_2025-01-08`, the index must be marked as read online as in the following example:

```shell
curl -X PUT "http://localhost:9200/operate-prefix-job-8.6.0_2025-01-08/_settings" -H "Content-Type: application/json" -d '{
  "settings": {
    "index.blocks.write": "true"
  }
}'
```

The archived index must then be cloned with an updated prefix:

```shell
curl -X POST "http://localhost:9200/operate-prefix-job-8.6.0_2025-01-08/_clone/new-prefix-job-8.6.0_2025-01-08" -H "Content-Type: application/json" -d '{
  "settings": {
    "index.blocks.write": false,
    "number_of_replicas": 0
  },
  "aliases": {
    "new-prefix-job-8.6.0_alias": {}
  }
}'
```

As stated in the [clone command description](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clone-index.html), the number of replicas is not copied over, and must be set explicitly. If not set, it may default to an incorrect value.

### Update to 8.7

With the Elasticsearch migration finished, ensure the following prior to updating to 8.7:

- The prefixes configured for Operate and Tasklist are changed to reflect the new prefix for the harmonized index. If this configuration is not changed, then Operate and Tasklist will continue to refer to the pre-migration indices which will not reflect any new changes.

  For example, given a new prefix of `some-prefix`:

  - The configured `CAMUNDA_OPERATE_ELASTICSEARCH_INDEX_PREFIX` must now be `some-prefix`.
  - The configured `CAMUNDA_TASKLIST_ELASTICSEARCH_INDEX_PREFIX` must now be `some-prefix`.
  - The prefix for the [Camunda exporter](/self-managed/zeebe-deployment/exporters/camunda-exporter.md) should be configured using `ZEEBE_BROKER_EXPORTERS_CAMUNDA_ARGS_INDEX_PREFIX` to `some-prefix`.
