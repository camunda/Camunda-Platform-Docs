---
id: 860-to-870
title: Update 8.6 to 8.7
description: "Review which adjustments must be made to migrate from Camunda 8.6.x to Camunda 8.7.0."
---

The following sections explain which adjustments must be made to migrate from Camunda 8.6.x to 8.7.x for each component.

## Backup

### Google Cloud Storage

Configuring a non-existing bucket for backups will not prevent Zeebe to start up anymore and will only result
in logs (at WARN) in the startup phase.

## Exported records

### `USER_TASK` records

To support User Task Listeners, some backward incompatible changes were necessary to the exported `USER_TASK` records.

#### `assignee` no longer provided in `CREATING/CREATED` events

Previously, when a user task was activating with a specified `assignee`,
we appended the following events of the `USER_TASK` value type:

- `CREATING` with `assignee` property as provided
- `CREATED` with `assignee` property as provided

The `ASSIGNING` and `ASSIGNED` events were not appended in this case.

To support the new User Task Listeners feature, the `assignee` value will not be filled in the `CREATING` and `CREATED` events anymore.

With 8.7, the following events are now appended:

- `CREATING` with `assignee` always `""` (empty string)
- `CREATED` with `assignee` always `""` (empty string)
- `ASSIGNING` with `assignee` property as provided
- `ASSIGNED` with `assignee` property as provided

#### `ASSIGNING` has become `CLAIMING` for `CLAIM` operation

When claiming a user task, we previously appended the following records of the `USER_TASK` value type:

- `CLAIM`
- `ASSIGNING`
- `ASSIGNED`

A new `CLAIMING` intent was introduced to distinquish between claiming and regular assigning.
We now append the following records when claiming a user task:

- `CLAIM`
- `CLAIMING`
- `ASSIGNED`

The `ASSIGNING` event is still appended for assigning a user task.
In that case, we append the following records:

- `ASSIGN`
- `ASSIGNING`
- `ASSIGNED`

## Prefix migration guide

If a custom prefix has bee defined for operate and tasklist then the migration of
data must be done manually to the new indices.

## Making the Elasticsearch instance reachable

The migration relies on communicating directly with Elasticsearch therefore the instance must be reachable on `http://localhost:9200`

- Kubernetes - a port forward should be used to make the instance reachable, `camunda-platform` can be replaced by the release name.

```shell
kubectl port-forward svc/camunda-platform-elasticsearch 9200:9200
```

## Creating harmonised indices

Creating the harmonised indices for migration

```shell
docker pull camunda/zeebe:SNAPSHOT
```

The `CAMUNDA_DATABASE_PREFIX` value should be set to your desired prefix.

```shell
docker run --rm -it --env CAMUNDA_DATABASE_URL="host.docker.internal:9200" --env CAMUNDA_DATABASE_INDEXPREFIX=<prefix> --entrypoint /usr/local/zeebe/bin/schema camunda/zeebe:SNAPSHOT
```

## Migrating to harmonised indices

Migrating to the harmonised indices will be done through reindexing.

1. Import into postman the collection `Prefix migration.postman_collection.json`
2. In the postman client set the global variables which template the requests, where `oldOperatePrefix` and `oldTasklistPrefix` are the prefixes which were previously configured and `prefix` is the new prefix for your harmonised indices.
3. Execute all requests in the collection.

## Migrating archived indices

for each archived index you will need to

- put it in read only mode
- clone the index with the changed name

Take for example `operate-prefix-job-8.6.0_2025-01-08`

You would need to mark the index as read only.

```shell
curl -X PUT "http://localhost:9200/operate-prefix-job-8.6.0_2025-01-08/_settings" -H "Content-Type: application/json" -d '{
  "settings": {
    "index.blocks.write": "true"
  }
}'
```

and then clone the archived index with an updated prefix.

```shell
curl -X POST "http://localhost:9200/operate-prefix-job-8.6.0_2025-01-08/_clone/new-prefix-job-8.6.0_2025-01-08" -H "Content-Type: application/json" -d '{
  "settings": {
    "index.blocks.write": false,
    "number_of_replicas": 0
  },
  "aliases": {
    "new-prefix-job-8.6.0_alias": {}
  }
}'

```

Also as per the clone command description https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clone-index.html, the number of replicas is not copied over so it must be set explicitly otherwise it may default to an incorrect value.

## Updating to 8.7

Now that the elastic migration has taken place an update to 8.7 is ready, provided the following:

- the prefixes configured for operate and task-list are changed to reflect the new prefix for the harmonised index. If this is not changed then operate and task-list will continue to refer to the pre migration indices which will not reflect any new changes. Given a new desired prefix of `some-prefix`
  - The configured `CAMUNDA_OPERATE_ELASTICSEARCH_INDEX_PREFIX` must now be `some-prefix`
  - The configured `CAMUNDA_TASKLIST_ELASTICSEARCH_INDEX_PREFIX` must now be `some-prefix`
- The prefix for the Camunda exporter should be configured `ZEEBE_BROKER_EXPORTERS_CAMUNDA_ARGS_INDEX_PREFIX` following the above example to `some-prefix`
